# This is an OpenAPI Specification (https://swagger.io/specification/)
# for organisation-data-service-fhir-api owned by NHS Digital (https://digital.nhs.uk/)
openapi: '3.0.0'
info:
  title: 'organisation-data-service-fhir-api'
  version: 'Computed and injected at build time by `scripts/set_version.py`'
  contact:
    name: 'ODS FHIR API Support'
    url: 'https://digital.nhs.uk/developer/help-and-support'
    email: api.management@nhs.net
  description: |
  
    <div class="nhsd-m-emphasis-box nhsd-m-emphasis-box--emphasis nhsd-!t-margin-bottom-6" aria-label="Highlighted Information">
        <div class="nhsd-a-box nhsd-a-box--border-blue">
            <div class="nhsd-m-emphasis-box__image-box">
                <figure class="nhsd-a-image">
                    <picture class="nhsd-a-image__picture">
                        <img src="http://digital.nhs.uk/binaries/content/gallery/icons/info.svg?colour=231f20" alt="" style="object-fit:fill">
                    </picture>
                </figure>
            </div>
            <div class="nhsd-m-emphasis-box__content-box">
            <p class="nhsd-t-heading-s nhsd-t-word-break" id="emphasis-emphasis-30709f1f" data-uipath="website.contentblock.emphasis.heading">Rate limits</p>
                <div data-uipath="website.contentblock.emphasis.content" class="nhsd-t-word-break"><p class="nhsd-t-body">This API is not designed for high volume usage - to ensure a good level of service you should aim to keep usage below 5 requests per second. For more details, see <a href="https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#rate-limits">rate limits</a>. We are working on increasing the capacity of the API. If you have an exceptional need for higher throughput, <a href="https://digital.nhs.uk/developer/help-and-support">contact us</a> to discuss your options.</p></div>            
            </div>
        </div>
    </div> 
  
    ## Overview
    Use this API to access a reduced dataset of health and social care organisations in England and Wales, such as trusts or GP practices, using the [Organisation Data Service (ODS)](https://digital.nhs.uk/services/organisation-data-service). 
    
    This FHIR API contains a reduced dataset, most useful for transactions. To access the full ODS dataset, including data about succession (history) or relationships, use the [ODS ORD API](http://https://digital.nhs.uk/developer/api-catalogue/organisation-data-service-ord).
    
    You can search for information about an organisation using one or more of their:
    - ODS code
    - last updated date
    - name
    - active or inactive status
    - postcode or city
    - organisation's role or primary role, such as trusts or GP practices
    
    You can also limit the number of results returned, or just request a count of the number of search results.
    
    You cannot:
    - access the full dataset from ODS, specifically no information about succession (history) or relationships
    - search for an organisation using an address
    
    An ODS code is a unique identification code for an organisation that interacts with any area of the NHS. For a full list of the organisation types available, see [CSV downloads](https://digital.nhs.uk/services/organisation-data-service/export-data-files/csv-downloads).
    
    This API returns the following reduced dataset of an organisation, when searched with an ODS code:
    
    - organisation - ODS code, name, open date, close date, last change date and status if active or inactive
    - address - house or flat number, line 1, line 2, line 3, town, postcode and country
    - contacts - email, website, telephone and fax
    - roles - primary and non-primary roles
   
    To access the full ODS dataset, use the [ODS ORD API](https://digital.nhs.uk/developer/api-catalogue/organisation-data-service-ord).
    
    <section class="nhsd-m-emphasis-box nhsd-m-emphasis-box--important nhsd-!t-margin-bottom-6" aria-label="Important Information">
        <div class="nhsd-a-box nhsd-a-box--border-yellow">
                <div class="nhsd-m-emphasis-box__image-box">
                    <figure class="nhsd-a-image">
                        <picture class="nhsd-a-image__picture">
                            <img src="http://digital.nhs.uk/binaries/content/gallery/icons/book-open.svg?colour=231f20" alt="" style="object-fit:fill" />
                        </picture>
                    </figure>
                </div>
            <div class="nhsd-m-emphasis-box__content-box">
                    <div data-uipath="website.contentblock.emphasis.content" class="nhsd-t-word-break"><p class="nhsd-t-body">For a non-technical overview of how to build software that deals with organisations and healthcare services, see <a href="https://digital.nhs.uk/developer/guides-and-documentation/building-healthcare-software/organisations-and-services">Building healthcare software - organisations and healthcare services</a>.</p></div>
            </div>
        </div>
    </section>
    
    ## Who can use this API
    This API can only be used to support the delivery of health and social care.
    
    ## Related APIs
    The following API also gives access to the Organisation Data Service:
    - [ODS Organisation Reference Data (ORD) API](https://digital.nhs.uk/developer/api-catalogue/organisation-data-service-ord) - use this API to access the full ODS dataset
    
    The following API is also related to this API:
    - [Spine Directory Service - FHIR API](https://digital.nhs.uk/developer/api-catalogue/spine-directory-service-fhir) - use this API to access ASID information and messaging endpoint details in the Spine Directory Service (SDS).
    
    ## API status and roadmap
    This API is [in production](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#statuses).
    
    To see our roadmap, or to suggest, comment or vote on features for this API, see our [interactive product backlog](https://nhs-digital-api-management.featureupvote.com/?order=popular&filter=allexceptdone&tag=ods-api#controls).
    
    If you have any other queries, [contact us](https://digital.nhs.uk/developer/help-and-support).
    
    ## Service level
    This API is a bronze service, meaning it is operational and supported only during business hours (8am to 6pm), Monday to Friday excluding bank holidays.
    
    For more details, see [service levels](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#service-levels).
    
    ## Technology
    This API is [RESTful](https://digital.nhs.uk/developer/guides-and-documentation/our-api-technologies#basic-rest).
    
    It also conforms to the [FHIR](https://digital.nhs.uk/developer/guides-and-documentation/our-api-technologies#fhir) global standard for health care data exchange. Specifically, it is based on the HL7 FHIR STU3 Messaging Implementation.
    
    You do not need to know much about FHIR to use this API - FHIR APIs are just RESTful APIs that follow specific rules. In particular:
    - resource names are capitalised, singular and in American English, for example `/Organization` not `/organisations`
    - array names are singular, for example `line` not `lines` for address lines
    - data items that are country-specific and thus not included in the FHIR global base resources are usually wrapped in an `extension` object
    
    There are [libraries and SDKs available](https://digital.nhs.uk/developer/guides-and-documentation/api-technologies-at-nhs-digital#fhir-libraries-and-sdks) to help with FHIR API integration.
    
    ## Network access
    This API is available on the internet and, indirectly, on the [Health and Social Care Network (HSCN)](https://digital.nhs.uk/services/health-and-social-care-network).
    
    ## Security and authorisation
    This API is [open-access](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation#open-access-apis), which means:
    - we do not authenticate or authorise the calling application
    - we do not authenticate or authorise the end user - they might not even be present
    
    We generally use open-access APIs for public data, where security is not a concern. Our open-access APIs are generally RESTful APIs. For more details on how to access them, see our [open-access REST API tutorial](https://https://digital.nhs.uk/developer/guides-and-documentation/tutorials/open-access-rest-api-tutorial).
    
    ## Environments and testing
    
    | Environments                | Base URLs                                                              |
    | -----------------           | ---------------------------------------------------------------------- |
    | User acceptance test (UAT)  |`https://uat.directory.spineservices.nhs.uk/STU3/`                      |
    | Production                  |`https://directory.spineservices.nhs.uk/STU3/`                          |
    
    For example:
    `https://uat.directory.spineservices.nhs.uk/STU3/Organization/RJY/`
    returns the reduced dataset for the organisation whose ODS code is RJY.
    
    ### Integration testing
    You can use the UAT environment to perform your integration testing.
    
    ## Onboarding
    This API is open-access, and there is no onboarding process or assurance required.
    
    ## Errors
    We use standard HTTP status codes to show whether an API request succeeded or not. They are usually in the range:
    - 200 to 299 if it succeeded, including code 202 if it was accepted by an API that needs to wait for further action
    - 400 to 499 if it failed because of a client error by your application
    - 500 to 599 if it failed because of an error on our server
    
    Errors specific to each API are shown in the Endpoints section, under Response. See our [reference guide](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#http-status-codes) for more on errors.

servers:
  - url: 'https://sandbox.api.service.nhs.uk/organisation-data-service-fhir-api'
    description: Sandbox environment.
  - url: 'https://int.api.service.nhs.uk/organisation-data-service-fhir-api'
    description: Integration test environment.
  - url: 'https://api.service.nhs.uk/organisation-data-service-fhir-api'
    description: Production environment.   
    
paths:
  /Organization/ID:
    get:
      summary: Search for an organisation ID
      
      operationId: get-single-organization-id
      description: |
        ## Overview
        Use this endpoint to return a single organisation for the specified ID (ODS code).
        
      parameters:
        - in: query
          name: _id
          description: |
            The organisation's ID - also known as its ODS code.
          required: true
          schema:
            type: string
            example: 'RTG'                            
      responses:
        '200':
          description: Valid request that returns organization history found that match the search criteria (which may be 0).
          content:
            application/fhir+json:
              example:
                {
                  "resourceType": "Organization",
                  "id": "RR8",
                  "meta": {
                      "lastUpdated": "2018-01-31T00:00:00+00:00",
                      "profile": "https://fhir.nhs.uk/STU3/StructureDefinition/ODSAPI-Organization-1"
                  },
                  "extension": [
                      {
                          "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-ActivePeriod-1",
                          "valuePeriod": {
                              "extension": [
                                  {
                                      "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-DateType-1",
                                      "valueString": "Operational"
                                  }
                              ],
                              "start": "1998-04-01"
                          }
                      },
                      {
                          "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-OrganizationRole-1",
                          "extension": [
                              {
                                  "url": "role",
                                  "valueCoding": {
                                      "system": "https://directory.spineservices.nhs.uk/STU3/CodeSystem/ODSAPI-OrganizationRole-1",
                                      "code": "197",
                                      "display": "NHS TRUST"
                                  }
                              },
                              {
                                  "url": "primaryRole",
                                  "valueBoolean": true
                              },
                              {
                                  "url": "activePeriod",
                                  "valuePeriod": {
                                      "extension": [
                                          {
                                              "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-DateType-1",
                                              "valueString": "Operational"
                                          }
                                      ],
                                      "start": "1998-04-01"
                                  }
                              },
                              {
                                  "url": "status",
                                  "valueString": "Active"
                              }
                          ]
                      }
                  ],
                  "identifier": {
                      "system": "https://fhir.nhs.uk/Id/ods-organization-code",
                      "value": "RR8"
                  },
                  "active": true,
                  "type": {
                      "coding": {
                          "system": "https://fhir.nhs.uk/STU3/CodeSystem/ODSAPI-OrganizationRecordClass-1",
                          "code": "1",
                          "display": "HSCOrg"
                      }
                  },
                  "name": "LEEDS TEACHING HOSPITALS NHS TRUST",
                  "telecom": [
                      {
                          "system": "fax",
                          "value": "0113 242 6496"
                      },
                      {
                          "system": "phone",
                          "value": "0113 243 3144"
                      }
                  ],
                  "address": {
                      "line": [
                          "ST. JAMES'S UNIVERSITY HOSPITAL",
                          "BECKETT STREET"
                      ],
                      "city": "LEEDS",
                      "district": "WEST YORKSHIRE",
                      "postalCode": "LS9 7TF",
                      "country": "ENGLAND"
                  }
              }
              
        '4XX':
          description: |
            An error occurred as follows:
            
            | HTTP status | Error code                 | Description |
            | ----------- | -------------------------- | --------------------------------------------- |
            | 404         | not-found                  | No record found.	|
            
  /Organization:
    get:
      summary: Search for an organisation
      
      operationId: get-organization-resources
      description: |
        ## Overview
        Use this endpoint to return a bundle of 'organization' resources that match the specified search criteria.
        
      parameters:
        - in: query
          name: _id
          description: |
            The organisation's ID - also known as its ODS code. If you already know the ODS code, consider using the 'Get organsiation details' endpoint instead.
          required: false
          schema:
            type: string
            example: 'RTG'
        - in: query
          name: identifier
          description: |
            The organisation's ID - also known as its ODS code.
            This parameter is similar to `_id` but can also explicitly include the code system for the ID - which must be `ods-organization-code`.
            It's included for FHIR compatibility.
          required: false
          schema:
            type: string
          examples:
            without-code-system:
              summary: 'This search uses just the ID:'
              value: 'RTG'
            with-code-system:
              summary: 'A search using the code system and ID:'
              value: 'https://fhir.nhs.uk/Id/ods-organization-code|RTG'
        - in: query
          name: _lastUpdated
          description: The date that the organisation was last updated. Only supports matching of updates that happened after the given date, using the prefix `gt` (greater than).
          required: false
          schema:
            type: string
            example: 'gt2017-04-01'
        - in: query
          name: name
          description: |
            The start of the organisation's name. For example, `Leeds` would match 'Leeds Chest Clinic' but not 'South Leeds Clinical Assessment Service'.
            
            Not case sensitive.
            
            Search expressions must:
            - contain a minimum of 3 characters and a maximum of 100 characters
            - only include the following characters: A-Z a-z 0-9 &()’+-_./:@ 'Space'
          required: false
          schema:
            type: string
            example: 'Leeds'
        - in: query
          name: name:contains
          description: |
            Any part of the organisation's name. For example, `Leeds` would match 'Leeds Chest Clinic' and 'South Leeds Clinical Assessment Service'.
            
            Not case sensitive.
            
            Search expressions must:
            - contain a minimum of 3 characters and a maximum of 100 characters
            - only include the following characters: A-Z a-z 0-9 &()’+-_./:@ 'Space'
          required: false
          schema:
            type: string
            example: 'Leeds'
        - in: query
          name: name:exact
          description: |
            The exact organisation name.
            
            Case sensitive.
            
            Search expressions must:
            - contain a minimum of 3 characters and a maximum of 100 characters
            - only include the following characters: A-Z a-z 0-9 &()’+-_./:@ 'Space'
          required: false
          schema:
            type: string
            example: 'LEEDS TEACHING HOSPITALS NHS TRUST'
        - in: query
          name: active
          description: Whether the organisation's record is still in active use.
          required: false
          schema:
            type: boolean
            example: 'true'
        - in: query
          name: address-postalcode
          description: |
            The start of the organisation's postcode.
            
            Not case sensitive.
            
            Search expressions must:
            - contain a minimum of 2 characters
            - only include alphanumeric characters or a space
          required: false
          schema:
            type: string
            example: 'LS1'
        - in: query
          name: address-postalcode:contains
          description: |
            Any part of the organisation's postcode.
            
            Not case sensitive.
            
            Search expressions must:
            - contain a minimum of 2 characters
            - only include alphanumeric characters or a space
          required: false
          schema:
            type: string
            example: '4DZ'
        - in: query
          name: address-postalcode:exact
          description: |
            The exact organisation postcode.
            
            Case sensitive.
            
            Search expressions must:
            - contain a minimum of 2 characters
            - only include alphanumeric characters or a space
          required: false
          schema:
            type: string
            example: 'LS1 4DZ'
        - in: query
          name: address-city
          description: |
            The start of the organisation's city address.
            
            Not case sensitive.
            
            Search expressions must:
            - contain a minimum of 2 characters
            - only include alphanumeric characters or a space
          required: false
          schema:
            type: string
            example: 'Derby'
        - in: query
          name: address-city:contains
          description: |
            Any part of the organisation's city address.
            
            Not case sensitive.
            
            Search expressions must:
            - contain a minimum of 2 characters
            - only include alphanumeric characters or a space
          required: false
          schema:
            type: string
            example: 'Derby'
        - in: query
          name: address-city:exact
          description: |
            The exact organisation city address.
            
            Case sensitive.
            
            Search expressions must:
            - contain a minimum of 2 characters
            - only include alphanumeric characters or a space
          required: false
          schema:
            type: string
            example: 'DERBY'
        - in: query
          name: ods-org-role
          description: |
            The organisation's role, based on the ODS organisation role code system.
            
            An organisation in ODS can have one or many roles.
            
            To search for organisations that have multiple roles (like an 'AND' operator), include the `ods-org-role` query parameter multiple times. For example:
            
            `GET https://directory.spineservices.nhs.uk/STU3/Organization?ods-org-role=76&ods-org-role=177`
            
            To search for organisations that have one of several roles (like an 'OR' operator), use a comma separator. For example:
            
            `GET https://directory.spineservices.nhs.uk/STU3/Organization?ods-org-role=197,198`
            
            You may combine 'AND' and 'OR' searches.
          required: false
          schema:
            type: string
          examples:
            without-code-system:
              summary: 'This search uses just the role code (197 = NHS trust):'
              value: '197'
            with-code-system:
              summary: 'A search using the code system and role code:'
              value: 'https://directory.spineservices.nhs.uk/STU3/STU3/CodeSystem/ODSAPI-OrganizationRole-1|197'
            multiple-roles:
              summary: "A search for multiple roles (like an 'OR' operator):"
              value: '197,198'
        - in: query
          name: ods-org-primaryRole
          description: Whether a role of the organisation is its primary role. Must be used in conjunction with the `ods-org-role` parameter.
          required: false
          schema:
            type: boolean
            example: 'false'
        - in: query
          name: _count
          description: Number of results to return. The maximum is 20.
          required: false
          schema:
            type: string
            example: ''
        - in: query
          name: _summary
          description: Return a count of the matching resources, without returning the actual matches.
          required: false
          schema:
            type: string
            enum: [count]
      responses:
        '200':
          description: Valid request that returns organization history found that match the search criteria (which may be 0).
          content:
            application/fhir+json:
              example:
                {
                  "resourceType": "Bundle",
                  "id": "2fe446ff-6d8e-492c-838a-10007976ae17",
                  "meta": {
                      "lastUpdated": "2018-05-01T10:21:05+00:00"
                  },
                  "type": "searchset",
                  "total": "95",
                  "link": [
                      {
                          "relation": "self",
                          "url": "https://directory.spineservices.nhs.uk/STU3/Organization?name=leeds&_count=1&_page=1"
                      },
                      {
                          "relation": "first",
                          "url": "https://directory.spineservices.nhs.uk/STU3/Organization?name=leeds&_count=1&_page=1"
                      },
                      {
                          "relation": "last",
                          "url": "https://directory.spineservices.nhs.uk/STU3/Organization?name=leeds&_count=1&_page=95"
                      },
                      {
                          "relation": "next",
                          "url": "https://directory.spineservices.nhs.uk/STU3/Organization?name=leeds&_count=1&_page=2"
                      }
                  ],
                  "entry": [
                      {
                          "fullUrl": "https://directory.spineservices.nhs.uk/STU3/Organization/03CAR",
                          "resource": {
                              "resourceType": "Organization",
                              "id": "03CAR",
                              "meta": {
                                  "lastUpdated": "2018-04-19T00:00:00+00:00",
                                  "profile": "https://fhir.nhs.uk/STU3/StructureDefinition/ODSAPI-Organization-1"
                              },
                              "extension": [
                                  {
                                      "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-ActivePeriod-1",
                                      "valuePeriod": {
                                          "extension": [
                                              {
                                                  "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-DateType-1",
                                                  "valueString": "Operational"
                                              }
                                          ],
                                          "start": "2013-10-01"
                                      }
                                  },
                                  {
                                      "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-ActivePeriod-1",
                                      "valuePeriod": {
                                          "extension": [
                                              {
                                                  "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-DateType-1",
                                                  "valueString": "Legal"
                                              }
                                          ],
                                          "start": "2013-10-01",
                                          "end": "2018-03-31"
                                      }
                                  },
                                  {
                                      "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-OrganizationRole-1",
                                      "extension": [
                                          {
                                              "url": "role",
                                              "valueCoding": {
                                                  "system": "https://directory.spineservices.nhs.uk/STU3/CodeSystem/ODSAPI-OrganizationRole-1",
                                                  "code": "99",
                                                  "display": "CLINICAL COMMISSIONING GROUP SITE"
                                              }
                                          },
                                          {
                                              "url": "primaryRole",
                                              "valueBoolean": true
                                          },
                                          {
                                              "url": "activePeriod",
                                              "valuePeriod": {
                                                  "extension": [
                                                      {
                                                          "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-DateType-1",
                                                          "valueString": "Operational"
                                                      }
                                                  ],
                                                  "start": "2013-10-01"
                                              }
                                          },
                                          {
                                              "url": "activePeriod",
                                              "valuePeriod": {
                                                  "extension": [
                                                      {
                                                          "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ODSAPI-DateType-1",
                                                          "valueString": "Legal"
                                                      }
                                                  ],
                                                  "start": "2013-10-01",
                                                  "end": "2018-03-31"
                                              }
                                          },
                                          {
                                              "url": "status",
                                              "valueString": "Active"
                                          }
                                      ]
                                  }
                              ],
                              "identifier": {
                                  "system": "https://fhir.nhs.uk/Id/ods-organization-code",
                                  "value": "03CAR"
                              },
                              "active": true,
                              "type": {
                                  "coding": {
                                      "system": "https://fhir.nhs.uk/STU3/CodeSystem/ODSAPI-OrganizationRecordClass-1",
                                      "code": "2",
                                      "display": "HSCSite"
                                  }
                              },
                              "name": "LEEDS WEST CCG (HQ)",
                              "address": {
                                  "line": [
                                      "UNITS 2-4 WIRA BUSINESS PARK"
                                  ],
                                  "city": "LEEDS",
                                  "district": "WEST YORKSHIRE",
                                  "postalCode": "LS16 6EB",
                                  "country": "ENGLAND"
                              }
                          }
                      }
                  ]
              }
        '4XX':
          description: |
            An error occurred as follows:
            
            | HTTP status | Error code                 | Description |
            | ----------- | -------------------------- | --------------------------------------------- |
            | 404         | not-found                  | No record found.	|
            | 400         | code-invalid      	       | Invalid code system. |
            | 400         | code-invalid               | Invalid code value. |
            | 400         | code-invalid               | Invalid identifier system.|
            | 400         | code-invalid               | Invalid identifier value. |
            | 400         | invalid                    | Invalid parameter.|
            | 400         | invalid                    | An input field has an invalid value for its type.|

          content:
            application/fhir+json:
              example:
                {
                  "resourceType": "OperationOutcome",
                  "id": "82c75580-1702-469e-aec1-43034b48f060",
                  "meta": {
                      "profile": "https://fhir.nhs.uk/STU3/StructureDefinition/Spine-OperationOutcome-1"
                  },
                  "issue": [
                      {
                          "severity": "error",
                          "code": "invalid",
                          "details": {
                              "coding": {
                                  "system": "https://fhir.nhs.uk/STU3/CodeSystem/Spine-ErrorOrWarningCode-1",
                                  "code": "INVALID_PARAMETER",
                                  "display": "Invalid parameter"
                              }
                          },
                          "diagnostics": "Unknown argument found - nam"
                      }
                  ]
              }

